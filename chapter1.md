# SVM

---

## 问题

SVM中文名称是支持向量机，解决的问题很普遍——分类。假设N维空间中有正例$$y = 1$$和负例$$y=-1$$的若干点，找到一个超平面将他们分开。

我们可以将超平面表示为$$w^Tx+b=0$$。

> 注意这个式子是超平面的一般式，有$$N+1$$个变量。实际上超平面只需要N个变量就可以，比如直线$$Ax + By + C = 0$$可以用截距式$$y = kx +b$$表示。也就是说，我们可以在一般式中给定一个约束，使得变量个数减少1，而几何表达能力不变。

我们直观地可以想到，假设超平面线性可分，那么我们最后的超平面放在两类边界点的中间是一个很好的选择。

![](/assets/20140829134548371.jpeg)

也就是满足
$$
\max\limits_{W,b} \min\limits_i \frac{W^Tx_i+b}{||W||}y_i
$$
> 这里的$$y_i$$是要将正负例分到不同的两侧，如果分到另一侧，得到距离的相反数，容易看出这种情况对于上式是不优的。接下来，我们考虑线性可分的情况，这种分错侧的平面将被排除。

下面我们要选择平面一般式中的那个约束了。当一个平面确定下来之后，它到各个数据点的距离就是确定的了，我们取的约束是到空间最近点的函数间隔$$(W^Tx+b)y_i $$为1。同时由于是最近点，其他点的函数间隔一定大于1。
所以上式可化为:
$$
\max\limits_{W,b} \frac{1}{||W||}
\\
st. \forall i,(W^Tx+b)y_i \geq 1
$$
> 其实这里本来应该限制存在一个点距离严格等于1的，但是此优化问题中可忽略。

将倒数求最大值转化为平方求最小值，即
$$
\min\limits_{W,b} \frac{1}{2}{||W||^2}
$$
>为什么是平方，是因为对于模平方最好求，同时问题是**凸问题**
## 转化
下面我们使用拉格朗日乘数法求带约束的极值问题。（见对应章节）
首先使用KKT条件中对W,b偏导为零，可以解出
$$
\frac{\nabla J}{\nabla W} = 0 \rightarrow W = \sum\limits_{i=1}^n \lambda_iy_ix_i\\
\frac{\nabla J}{\nabla b} = 0 \rightarrow \sum\limits_{i=1}^n\lambda_iy_i = 0
$$
代入拉格朗日函数容易算出
$$J(W,b,\lambda) = \sum\limits_{i=1}^n\lambda_i - \frac{1}{2}\sum\limits_{i,j=1}^n\lambda_i\lambda_jy_iy_jx_i^Tx_j$$
这里的减号是因为限制是大于等于，化成标准要反号。
剩下的KKT条件：
