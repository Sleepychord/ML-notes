# 拉格朗日乘数法
---

我们来考虑带约束的多元函数极值问题，拉格朗日乘数法
是解这类问题常用解法。
$$
min \ F(x), \ st. h(x)_i=0(i = 0,1,2...m)
$$
其中x为n维向量，不妨假设这里的函数足够光滑，有极值。
注意到一个非常重要的性质：
> 极值点处，目标函数梯度与限制函数的解空间垂直

反证：如果不垂直，那么在极值点附近、解空间内沿着梯度分量或其反方向走，必能使得函数值增大或减小。

更直观的解释见下图，红色是解空间，蓝色虚线是目标函数的等高线。在极值点处目标函数梯度方向与解空间垂直；可以想象如果是三维，那么解空间可能是一个平面的形式，此时极值点处梯度方法应该跟解平面法线平行。
![](/assets/359cdc26e15205e66204bce2b33e4535_b.jpg)
如果有多个限制函数，那么我们只能在解空间交集中取值，此时梯度方向只需与这个交集（也就是两个限制函数解空间的张成）垂直。
即$$
\nabla F = \lambda_1\nabla h_1 + \lambda_2\nabla h_2 + ... + \lambda_m\nabla h_m
$$
在极值点处成立。结合m各限制函数为零本身，可以得到n+m个n+m元方程。
如果我们记拉格朗日函数为$$
J(x,\lambda) = F(x) + \sum\limits_{i=1}^{m} \lambda_ih_i(x)
$$
这个n+m元方程组就可以写成$$ \left\{
\begin{aligned}
& \frac{\partial J}{x_i}= 0 &(i=1,...,n)\\
& \frac{\partial J}{\lambda_i}= 0& (i=1,...,m)
\end{aligned}
\right.
$$
至此我们将有限制的多元函数极值问题转化成了解非线性方程组的问题，当然这个问题仍然并非那么简单，但是很多问题中我们可以手动进行计算化简；如果足够光滑，解也比较唯一，我们可以使用牛顿迭代法解非线性方程组。